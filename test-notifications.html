<!DOCTYPE html>
<html>
<head>
    <title>Notification Test</title>
</head>
<body>
    <h1>Notification Test Page</h1>
    <button onclick="requestPermission()">1. Request Permission</button>
    <button onclick="sendNotification()">2. Send Test Notification</button>
    
    <script>
        function requestPermission() {
            Notification.requestPermission().then(permission => {
                alert('Permission: ' + permission);
            });
        }
        
        function sendNotification() {
            if (Notification.permission === 'granted') {
                // Using Data URI instead of external URL
                const iconDataURI = 'data:image/svg+xml;base64,' + btoa(`
                    <svg xmlns="http://www.w3.org/2000/svg" width="192" height="192" viewBox="0 0 100 100">
                        <rect width="100" height="100" fill="#3498db"/>
                        <text x="50" y="60" font-size="40" text-anchor="middle" fill="white">DM</text>
                    </svg>
                `);
                
                new Notification('Test Notification', {
                    body: 'This is working! No internet needed.',
                    icon: iconDataURI,
                    badge: iconDataURI
                });
                alert('Notification sent! Check top-right corner.');
            } else {
                alert('Please grant permission first. Current: ' + Notification.permission);
            }
        }
        
        // Check on load
        console.log('Notification supported:', 'Notification' in window);
        console.log('Current permission:', Notification.permission);
    </script>
</body>
</html>
